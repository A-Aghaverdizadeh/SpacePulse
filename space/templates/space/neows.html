{% extends "base.html" %}
{% load static %}

{% block css %}
    <style>
        .pie-chart {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            background: conic-gradient(
                #ff6b6b 0% {{ danger_pct }}%,
                #4cd964 {{ danger_pct }}% 100%
            );
            margin: 0 auto;
            position: relative;
        }
        .pagination-btn svg{
            width: 20px;
            height: 20px;
        }
    </style>
    <link rel="stylesheet" href="{% static 'css/neows.css' %}">
{% endblock css %}

{% block content %}
     <!-- نوار ناوبری -->
    
    {% include 'include/header.html' %}
    
    <!-- پس زمینه ستاره ها -->
    <div class="stars" id="stars"></div>
    
    <!-- خورشید برای حالت روز -->
    <div class="sun"></div>
    
    <!-- ابرهای شناور -->
    <div class="cloud cloud-1"></div>
    <div class="cloud cloud-2"></div>
    <div class="cloud cloud-3"></div>
    
    <!-- سیاره تزئینی -->
    <div class="planet"></div>
    
    <div class="container">
        <header>
            <h1>سامانه ردیابی اجرام نزدیک به زمین (NeoWs)</h1>
            <p class="subtitle">پایش و رصد اجرام آسمانی که از نزدیکی زمین عبور می‌کنند</p>
        </header>
        
        <!-- فیلترها و جستجو -->
        {% comment %}         
            <div class="filters">
                <div class="filter-group">
                    <label for="date">تاریخ</label>
                    <input type="date" id="date" value="2023-08-30">
                </div>
                
                <div class="filter-group">
                    <label for="hazardous">خطر برخورد</label>
                    <select id="hazardous">
                        <option value="all">همه اجرام</option>
                        <option value="true">خطرناک</option>
                        <option value="false">بی‌خطر</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="distance">فاصله از زمین</label>
                    <select id="distance">
                        <option value="all">همه فواصل</option>
                        <option value="close">نزدیک (کمتر از 1 میلیون km)</option>
                        <option value="medium">متوسط (1 تا 5 میلیون km)</option>
                        <option value="far">دور (بیش از 5 میلیون km)</option>
                    </select>
                </div>
                
                <div class="filter-buttons">
                    <button class="btn btn-primary" id="apply-filters">
                        <i class="fas fa-filter"></i>
                        اعمال فیلتر
                    </button>
                    <button class="btn btn-secondary" id="reset-filters">
                        <i class="fas fa-redo"></i>
                        بازنشانی
                    </button>
                </div>
            </div>
         {% endcomment %}
        <!-- آمار کلی -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-label">تعداد کل اجرام امروز</div>
                <div class="stat-value">{{ neows_count }}</div>
                <div class="stat-label">جرم نزدیک به زمین</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">اجرام خطرناک</div>
                <div class="stat-value">{{ neows_danger }}</div>
                <div class="stat-label">Potential Hazardous Asteroids</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">نزدیک‌ترین فاصله</div>
                <div class="stat-value">{{ min_distance|floatformat:2 }} کیلومتر</div>
                <div class="stat-label">از مرکز زمین</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">بزرگ‌ترین جرم</div>
                <div class="stat-value">{{ max_diameter|floatformat:2 }} متر</div>
                <div class="stat-label">قطر تخمینی</div>
            </div>
        </div>
        
        <!-- نمودار -->
        <div class="chart-container">
            <h3 class="chart-title">توزیع اجرام بر اساس سطح خطر</h3>
            <div class="pie-chart"></div>
            <div class="chart-legend">
                <div class="legend-item">
                    <div class="legend-color legend-danger"></div>
                    <div class="legend-text">اجرام خطرناک ({{ neows_danger }})</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color legend-safe"></div>
                    <div class="legend-text">اجرام بی‌خطر ({{ neows_safe }})</div>
                </div>
            </div>
        </div>
        
        <!-- لیست اجرام -->
        <h2 style="color: #8f94fb; margin-bottom: 1.5rem; padding-right: 1rem;">اجرام نزدیک به زمین در تاریخ ۱۰ شهریور ۱۴۰۲</h2>
        
        <div class="neo-grid" id='neo-grid'>
            <!-- جرم ها -->
        </div>
        
        <!-- صفحه‌بندی -->
        <div class="pagination">
            <a href="#" id="prev-page" class='pagination-btn'>
                {% include 'svg/arrow-right.svg' %}
            </a>
            <span id="page-numbers"></span>
            <a href="#" id="next-page" class='pagination-btn'>
                {% include 'svg/arrow-left.svg' %}
            </a>
        </div>
    </div>
{% endblock content %}

{% block script %}
    <script src="{% static 'js/neows.js' %}"></script>
{% endblock script %}